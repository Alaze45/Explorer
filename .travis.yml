matrix:
  include:
    - os: linux
      language: android
      jdk: openjdk8
      android:
        components:
          - platform-tools
          - tools
          - build-tools-24.0.2
          - android-25
          - sys-img-armeabi-v7a-android-25
          - extra-android-m2repository
          - sys-img-armeabi-v7a-addon-google_apis-google-25
          - sys-img-armeabi-v7a-addon-google_apis-google-25
      dist: trusty
      sudo: true
      compiler: gcc
      addons:
        apt:
          packages:
            - cmake
            - ninja-build
          sources:
            - ubuntu-toolchain-r-test
      env: CMAKE_BUILD_TYPE=DEBUG

    - os: linux
      dist: trusty
      sudo: true
      compiler: gcc
      addons:
        apt:
          packages:
            - cmake
            - ninja-build
          sources:
            - ubuntu-toolchain-r-test
      env: CMAKE_BUILD_TYPE=RELEASE

before_script:
  - echo no | android create avd --force -n test -t android-25 --abi armeabi-v7a
  - emulator -avd test -no-skin -no-audio -no-window &
  - android-wait-for-emulator
  - adb shell input keyevent 82 &

script:
  - ./gradlew connectedAndroidTest
